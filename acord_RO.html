<!DOCTYPE html>
<html lang="ro">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Acord informat nutriție și stil de viață | Nutrisib</title>
    <meta name="description" content="Formular de acord informat pentru pacienții Nutrisib. Detalii despre planul nutrițional ReDefine.">
    <meta name="author" content="dr. ing. Radu Pascu">
    <meta name="robots" content="noindex, nofollow">
    
    <meta property="og:title" content="Acord informat nutriție și stil de viață | Nutrisib">
    <meta property="og:description" content="Formular de acord informat pentru pacienții Nutrisib. Detalii despre programul ReDefine.">
    <meta property="og:type" content="article">
    <meta property="og:locale" content="ro_RO">
    <meta property="og:image" content="https://nutrisib.club/imagini/nutrisib-logo.jpg">

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap');

        :root {
            --dark-blue: #0A2463;
            --medium-blue: #3E92CC;
            --light-blue: #A4D3EE;
            --text-dark: #212529;
            --text-light: #475569;
            --bg-light: #f8f9fa;
            --bg-white: #ffffff;
            --accent-green: #2ECC71;
            --border-color: #e0e0e0;
            --accent-gold: #c6a75e;
            --error-red: #dc3545;
        }

        body {
            font-family: 'Inter', sans-serif;
            line-height: 1.45;
            color: var(--text-dark);
            background-color: var(--bg-light);
            margin: 0;
            padding: 1rem;
        }

        .infographic-container {
            max-width: 900px;
            margin: auto;
            background-color: var(--bg-white);
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
            overflow: hidden;
        }

        header.infographic-header {
            background: linear-gradient(135deg, var(--dark-blue), var(--medium-blue));
            color: white;
            padding: 1.5rem 1rem;
            text-align: center;
        }

        header.infographic-header h1 {
            font-size: 2rem;
            font-weight: 800;
            margin: 0;
            text-shadow: 1px 1px 2px rgba(0,0,0,0.2);
        }

        header.infographic-header p {
            font-size: 1rem;
            color: #ffffff;
            opacity: 1;
            max-width: 700px;
            margin: 0.5rem auto 0;
        }

        .infographic-section {
            padding: 1rem 2rem;
            border-bottom: 1px solid var(--border-color);
        }

        .infographic-section:last-of-type {
            border-bottom: none;
        }

        .section-title {
            display: flex;
            align-items: center;
            gap: 12px;
            margin-bottom: 0.8rem;
        }

        .section-title .icon {
            flex-shrink: 0;
            width: 36px;
            height: 36px;
            display: grid;
            place-items: center;
            border-radius: 50%;
            background-color: var(--light-blue);
            color: var(--dark-blue);
        }

        .section-title .icon svg {
            width: 20px;
            height: 20px;
            stroke: currentColor;
            stroke-width: 2;
        }
        
        .section-title h2 {
            font-size: 1.3rem;
            font-weight: 700;
            color: var(--dark-blue);
            margin: 0;
            border: none;
            padding-left: 0;
        }

        p, li { 
            font-size: 0.95rem; 
            color: var(--text-light);
            margin-bottom: 0.5rem;
            margin-top: 0;
        }
        
        ul, ol { 
            padding-left: 20px; 
            margin-top: 0.5rem;
            margin-bottom: 0.5rem;
        }

        .financial-clause {
            background-color: transparent;
            border: 1px solid var(--border-color);
            padding: 1rem;
            margin: 0.8rem 0;
            border-radius: 6px;
        }
        
        .wellness-box {
            background-color: transparent;
            padding: 1rem;
            border-radius: 6px;
            border: 1px solid var(--border-color);
            margin-top: 0.8rem;
        }
        
        /* Form Grids */
        .form-grid-3-cols {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr; /* Nume, CNP, Data */
            gap: 15px;
            margin-bottom: 15px;
        }

        .form-grid-3 {
            display: grid;
            grid-template-columns: 1fr 1fr 0.5fr; /* Judet, Loc, Cod */
            gap: 15px;
            margin-bottom: 10px;
        }
        
        .form-grid-address-2 {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .form-grid-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 10px;
        }

        .form-group { margin-bottom: 0; }
        .form-group-full { margin-bottom: 10px; }

        label { 
            display: block; 
            font-weight: 600; 
            margin-bottom: 4px; 
            color: var(--dark-blue);
            font-size: 0.95rem;
        }
        
        input[type="text"], input[type="email"], input[type="date"], input[type="tel"], select {
            width: 100%;
            padding: 10px; 
            border: 1px solid #ccc;
            border-radius: 4px;
            box-sizing: border-box;
            font-family: inherit;
            font-size: 1rem;
            transition: border-color 0.3s;
            background-color: #fff;
        }
        
        input:read-only {
            background-color: #e9ecef;
            cursor: not-allowed;
            color: #6c757d;
        }

        input:focus, select:focus {
            outline: none;
            border-color: var(--medium-blue);
            box-shadow: 0 0 0 3px rgba(62, 146, 204, 0.1);
        }

        input:invalid {
            border-color: var(--error-red);
        }

        /* Stil specific pentru secțiunea tutorelui */
        #guardian-section {
            border-top: 2px dashed var(--medium-blue);
            margin-top: 20px;
            padding-top: 15px;
            background-color: #fffbeb; 
            border-radius: 6px;
            padding: 15px;
        }

        /* Ascundere câmp Honeypot */
        .hidden { display: none; }

        .signing-options {
            background: #fff;
            padding: 1.5rem;
            border-radius: 8px;
            margin-top: 1.5rem;
            border: 1px solid var(--border-color);
        }
        .signing-options h3 {
            color: var(--dark-blue);
            margin-top: 0;
            font-size: 1.1rem;
            margin-bottom: 0.8rem;
        }
        .radio-group {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }
        .radio-option {
            display: flex;
            align-items: center;
            cursor: pointer;
            font-weight: 600;
            color: var(--text-dark);
            font-size: 0.95rem;
        }
        .radio-option input { margin-right: 6px; }

        .sign-method { display: none; }
        .sign-method.active { display: block; animation: fadeIn 0.5s; }

        canvas {
            border: 2px dashed #aaa;
            background: #fff;
            cursor: crosshair;
            width: 100%;
            max-width: 100%;
            height: 180px; 
            touch-action: none;
            display: block;
            border-radius: 4px;
        }
        .canvas-controls {
            margin-top: 5px;
            text-align: right;
        }
        
        .btn {
            background: linear-gradient(135deg, var(--dark-blue), var(--medium-blue));
            color: white;
            padding: 12px 24px;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 700;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .btn:hover { 
            transform: translateY(-1px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }
        .btn-secondary {
            background: #6c757d;
            font-size: 0.85rem;
            padding: 6px 14px;
            font-weight: normal;
            box-shadow: none;
        }
        .btn-print {
            background: var(--accent-green);
            margin-bottom: 10px;
            display: inline-block;
            text-decoration: none;
            color: white;
            text-align: center;
            padding: 12px 24px;
            border-radius: 4px;
            border: none;
            cursor: pointer;
            font-weight: 600;
            font-size: 0.95rem;
        }
        .btn-print:hover { background-color: #27ae60; }

        /* Mesaj Succes (Ascuns inițial) */
        #success-message {
            display: none;
            text-align: center;
            padding: 40px;
        }
        #success-message h2 { color: var(--accent-green); }

        .footer-social-links { 
            display: flex; 
            justify-content: center; 
            gap: 15px; 
            margin-bottom: 0.2rem; 
        }
        .footer-social-links a { display: inline-block; transition: transform 0.2s ease; }
        .footer-social-links a:hover { transform: scale(1.1); }
        .footer-social-links svg, .footer-social-links img { width: 28px; height: 28px; }

        footer.infographic-footer {
            background-color: var(--text-dark); 
            color: #ffffff;
            text-align: center; 
            padding: 1.5rem 1rem;
            margin-top: 2rem;
        }
        
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media print {
            .no-print { display: none !important; }
            body { background: white; padding: 0; }
            .infographic-container { box-shadow: none; border-radius: 0; max-width: 100%; }
            .infographic-section { page-break-inside: avoid; }
        }

        @media (max-width: 768px) {
            .form-grid-3-cols, .form-grid-3, .form-grid-address-2, .form-grid-row {
                grid-template-columns: 1fr;
            }
            header.infographic-header h1 { font-size: 1.5rem; }
            .infographic-section { padding: 1rem; }
        }
    </style>
</head>
<body>

    <div class="infographic-container">
        <header class="infographic-header">
            <h1>Acord Informat</h1>
            <p>Nutrisib | ReDefine – Reconstrucție metabolică prin știință și logică</p>
        </header>

        <div id="success-message">
            <h2>✓ Trimitere reușită!</h2>
            <p>Vă mulțumim! Acordul dumneavoastră a fost trimis cu succes către echipa Nutrisib.</p>
            <button class="btn" onclick="window.location.reload()">Completează din nou</button>
        </div>

        <!-- FORMULAR PROPRIU-ZIS -->
        <form id="acordForm" name="acord_RO" method="POST" action="/" data-netlify="true" data-netlify-honeypot="bot-field" enctype="multipart/form-data">
            <input type="hidden" name="form-name" value="acord_RO" />
            <p class="hidden">
                <label>Don’t fill this out if you’re human: <input name="bot-field" /></label>
            </p>

            <section class="infographic-section" id="Identificare">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 6a3.75 3.75 0 11-7.5 0 3.75 3.75 0 017.5 0zM4.501 20.118a7.5 7.5 0 0114.998 0A17.933 17.933 0 0112 21.75c-2.676 0-5.216-.584-7.499-1.632z" /></svg>
                    </div>
                    <h2>1. Date de identificare</h2>
                </div>
                
                <div class="form-grid-3-cols">
                    <div class="form-group">
                        <label for="full_name">Nume și Prenume</label>
                        <input type="text" id="full_name" name="nume_complet" required placeholder="Ex: Popescu Ion">
                    </div>
                    <div class="form-group">
                        <label for="cnp">CNP</label>
                        <input type="text" id="cnp" name="cnp" required maxlength="13" placeholder="13 cifre" oninput="handleCNPChange(this)">
                        <small id="cnpError" style="color: red; display: none;">CNP invalid!</small>
                    </div>
                    <div class="form-group">
                        <label for="dob">Data Nașterii</label>
                        <input type="date" id="dob" name="data_nasterii" readonly>
                    </div>
                </div>

                <div class="form-grid-3">
                    <div class="form-group">
                        <label for="county">Județ</label>
                        <input type="text" id="county" name="judet" required>
                    </div>
                    <div class="form-group">
                        <label for="city">Localitate</label>
                        <input type="text" id="city" name="localitate" required>
                    </div>
                    <div class="form-group">
                        <label for="zip">Cod Poștal</label>
                        <input type="text" id="zip" name="cod_postal">
                    </div>
                </div>

                <div class="form-grid-address-2">
                    <div class="form-group">
                        <label for="address">Adresă (Stradă, Nr, Bl, Ap)</label>
                        <input type="text" id="address" name="adresa" required>
                    </div>
                    <div class="form-group">
                        <label for="phone">Telefon</label>
                        <input type="tel" id="phone" name="telefon" required>
                    </div>
                </div>

                <div class="form-group-full">
                    <label for="email">Email</label>
                    <input type="email" id="email" name="email" required>
                </div>

                <!-- Secțiune Tutore (Apare doar pentru minori) -->
                <div id="guardian-section" style="display: none;">
                    <label style="color: #b45309; font-size: 1.1rem;">Secțiune pentru Tutore Legal (Minor < 18 ani)</label>
                    <p><small>Deoarece sunteți minor, este necesar acordul unui părinte sau tutore legal.</small></p>
                    <div class="form-grid-row">
                        <div class="form-group">
                            <label for="guardian_name">Nume Tutore</label>
                            <input type="text" id="guardian_name" name="nume_tutore">
                        </div>
                        <div class="form-group">
                            <label for="guardian_cnp">CNP Tutore</label>
                            <input type="text" id="guardian_cnp" name="cnp_tutore" maxlength="13">
                        </div>
                    </div>
                </div>
            </section>

            <section class="infographic-section" id="scop">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M3.75 13.5l10.5-11.25L12 10.5h8.25L9.75 21.75 12 13.5H3.75z" /></svg>
                    </div>
                    <h2>2. Scopul și natura serviciilor</h2>
                </div>
                <p>Prezentul acord definește cadrul de colaborare dintre Nutrisib și dumneavoastră în cadrul programului <strong>ReDefine</strong>. Scopul nostru este reconstrucția metabolică prin știință și logică.</p>
                <p>Serviciile includ:</p>
                <ul>
                    <li>Evaluarea stării nutriționale pe baza anamnezei și a analizelor.</li>
                    <li>Elaborarea planului nutrițional personalizat.</li>
                    <li>Pachetul de suplimente ReDefine - Protocolul de suplimentare personalizat</li>
                    <li>Educație nutrițională și monitorizare continuă.</li>
                </ul>
            </section>

            <section class="infographic-section" id="program-financiar">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 012.25-2.25h13.5A2.25 2.25 0 0121 7.5v11.25m-18 0A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75m-18 0v-7.5A2.25 2.25 0 015.25 9h13.5A2.25 2.25 0 0121 11.25v7.5" /></svg>
                    </div>
                    <h2>3. Programul ReDefine – durată și angajament financiar</h2>
                </div>
                <div class="financial-clause">
                    <p><strong>A. Durata:</strong> Programul de redefinire metabolică se desfășoară pe <strong>4 luni</strong> consecutive pentru un răspuns fiziologic stabil.</p>
                    <p><strong>B. Pachetul ReDefine:</strong> Protocolul include furnizarea lunară a suplimentelor personalizate.</p>
                    <p><strong>C. Obligația de plată:</strong> Clientul își exprimă <strong>consimțământul ferm pentru achiziția lunară</strong> pe durata celor 4 luni. Întreruperea nu exonerează de plata comenzilor în curs.</p>
                </div>
            </section>

            <section class="infographic-section" id="parteneriat">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M18 18.72a9.094 9.094 0 003.741-.479 3 3 0 00-4.682-2.72m.94 3.198l.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0112 21c-2.17 0-4.207-.576-5.963-1.584A9.06 9.06 0 016 18.719m12 0c.212.016.42.028.63.037.207.009.41.014.614.014a3 3 0 00.418-5.963m-13.084-2.818A11.961 11.961 0 0112 3c2.17 0 4.207.576 5.963 1.584A9.06 9.06 0 0118 6.281m-12 0c-.212-.016-.42-.028-.63-.037a3 3 0 00-4.18 5.963m13.084 2.818c-.207-.009-.41-.014-.614-.014a3 3 0 00-2.828 0M12 3v9m0 9v-9" /></svg>
                    </div>
                    <h2>4. Declarația de parteneriat și responsabilități</h2>
                </div>
                <p>Înțeleg că Nutrisib este un partener și un ghid care oferă harta teritoriului meu interior. </p>
                <p>Înțeleg și accept următoarele:</p>
                <ul>
                    <li><strong>Rolul activ:</strong> Sunt conștient că rezultatele depind direct de implementarea recomandărilor primite. Specialistul oferă strategia și instrumentele, dar eu sunt responsabil de execuție.</li>
                    <li><strong>Transparența datelor:</strong> Mă oblig să furnizez informații complete și reale despre starea mea de sănătate și istoricul medical.</li>
                    <li><strong>Angajament pe termen mediu:</strong> Accept că reconstrucția metabolică este un proces care necesită timp, motiv pentru care am aderat la programul de 4 luni.</li>
                </ul>
            </section>

            <section class="infographic-section" id="confidentialitate">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M16.5 10.5V6.75a4.5 4.5 0 10-9 0v3.75m-.75 11.25h10.5a2.25 2.25 0 002.25-2.25v-6.75a2.25 2.25 0 00-2.25-2.25H6.75a2.25 2.25 0 00-2.25 2.25v6.75a2.25 2.25 0 002.25 2.25z" /></svg>
                    </div>
                    <h2>5. Confidențialitate și protecția datelor (GDPR)</h2>
                </div>
                <p>Datele dumneavoastră cu caracter personal și medical sunt prelucrate în strictă conformitate cu Regulamentul (UE) 2016/679.</p>
                <ul>
                    <li>Datele sunt colectate exclusiv pentru elaborarea planului nutrițional, a protocolului de suplimentare și comunicarea directă.</li>
                    <li>Aveți dreptul de a solicita oricând accesul, rectificarea sau ștergerea datelor dumneavoastră.</li>
                </ul>
            </section>

            <section class="infographic-section" id="rol-suplimente">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M21 8.25c0-2.485-2.099-4.5-4.688-4.5-1.935 0-3.597 1.126-4.312 2.733-.715-1.607-2.377-2.733-4.313-2.733C5.1 3.75 3 5.765 3 8.25c0 7.22 9 12 9 12s9-4.78 9-12z" /></svg>
                    </div>
                    <h2>6. Rolul suplimentelor și viziunea holistică (Disclaimer)</h2>
                </div>
                <p>Suplimentele alimentare din pachetul ReDefine au rolul de a corecta carențele nutriționale, de a optimiza reacțiile biochimice și de a susține procesele fiziologice normale. Clientul înțelege și acceptă că acestea nu sunt medicamente și nu au rolul de a trata boli, ci de a restabili echilibrul.</p>

                <div class="wellness-box">
                    <p>La <strong>NUTRISIB</strong>, credem că sănătatea nu este doar absența bolii, ci o stare dinamică de echilibru și prosperitate în toate aspectele vieții. Această stare holistică este ceea ce numim <strong>Wellness</strong> și se manifestă în 8 domenii interconectate:</p>
                    <ul>
                        <li><strong>Fizic:</strong> Cum te simți în corpul tău – energie, vitalitate, rezistență.</li>
                        <li><strong>Mental:</strong> Claritate, focus, managementul stresului, starea emoțională.</li>
                        <li><strong>Spiritual:</strong> Conexiunea cu sinele, sensul și scopul în viață.</li>
                        <li><strong>Financiar:</strong> Siguranță, libertate, gestionarea resurselor.</li>
                        <li><strong>Ocupațional:</strong> Satisfacție profesională, echilibru muncă-viață.</li>
                        <li><strong>Social:</strong> Relații armonioase, apartenență la o comunitate.</li>
                        <li><strong>Intelectual:</strong> Curiozitate, învățare continuă, dezvoltare personală.</li>
                        <li><strong>De Mediu:</strong> Locul în care trăiești și cum te influențează.</li>
                    </ul>
                </div>
            </section>

            <section class="infographic-section" id="riscuri">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126zM12 15.75h.007v.008H12v-.008z" /></svg>
                    </div>
                    <h2>7. Riscuri și limitări</h2>
                </div>
                <p>Dacă pe parcursul programului apar stări de disconfort major, mă oblig să informez imediat specialistul. Serviciile de nutriție nu înlocuiesc tratamentele medicale de urgență.</p>
            </section>

            <section class="infographic-section" id="consimtamant">
                <div class="section-title">
                    <div class="icon">
                        <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" d="M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10" /></svg>
                    </div>
                    <h2>8. Consimțământ final</h2>
                </div>
                <p>Prin semnarea acestui document:</p>
                <ol>
                    <li>Confirm că am citit și am înțeles termenii colaborării, în special durata de 4 luni a programului și rolul suplimentelor ca suport în cadrul unui stil de viață echilibrat.</li>
                    <li>Îmi exprim acordul ferm pentru achiziția și plata lunară a pachetului de suplimente personalizat ReDefine.</li>
                    <li>Consimt la prelucrarea datelor mele personale în scopurile menționate.</li>
                </ol>

                <div class="signing-options no-print">
                    <h3>Alegeți metoda de semnare:</h3>
                    
                    <div class="radio-group">
                        <label class="radio-option">
                            <input type="radio" name="signMethod" value="digital" checked onclick="toggleSignMethod('digital')">
                            Semnează acum (ecran tactil / mouse)
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="signMethod" value="upload" onclick="toggleSignMethod('upload')">
                            Printează, semnează și încarcă
                        </label>
                        <label class="radio-option">
                            <input type="radio" name="signMethod" value="qualified" onclick="toggleSignMethod('qualified')">
                            Semnătură electronică calificată
                        </label>
                    </div>

                    <div id="method-digital" class="sign-method active">
                        <p><small>Prin semnarea în caseta de mai jos, confirmați acceptarea termenilor contractuali și financiari de mai sus:</small></p>
                        <canvas id="signatureCanvas" width="700" height="200"></canvas>
                        <input type="hidden" name="signatureData" id="signatureData">
                        <div class="canvas-controls">
                            <button type="button" class="btn btn-secondary" onclick="clearCanvas()">Șterge semnătura</button>
                        </div>
                    </div>

                    <div id="method-upload" class="sign-method">
                        <p>1. Completați datele de mai sus.<br>
                        2. Apăsați butonul de printare de mai jos.<br>
                        3. Semnați olograf documentul.<br>
                        4. Scanați sau fotografiați documentul și încărcați-l aici:</p>
                        <input type="file" id="fileUpload" name="fisier_semnat_olograf" accept=".pdf, .jpg, .jpeg, .png">
                    </div>

                    <div id="method-qualified" class="sign-method">
                        <p>1. Completați datele de mai sus.<br>
                        2. Printați documentul ca PDF (butonul de mai jos).<br>
                        3. Aplicați semnătura electronică calificată.<br>
                        4. Încărcați documentul semnat digital aici:</p>
                        <input type="file" id="qualifiedUpload" name="fisier_semnat_digital" accept=".pdf, .p7m">
                    </div>
                </div>

                <div style="margin-top: 2rem; text-align: center;">
                    <button type="button" class="btn-print no-print" onclick="window.print()" style="margin-right: 10px;">
                        Printează / Salvează PDF
                    </button>
                    <button type="submit" id="submitBtn" class="btn">
                        Trimite Acordul Finalizat
                    </button>
                </div>
            </section>
        </form>

        <footer class="infographic-footer">
            <div class="footer-social-links">
                <a href="https://www.facebook.com/nutrisib" target="_blank">
                    <svg fill="#ffffff" viewBox="0 0 24 24"><path d="M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"/></svg>
                </a>
                <a href="https://www.instagram.com/nutrisib" target="_blank">
                    <svg fill="#ffffff" viewBox="0 0 24 24"><path d="M12 2.163c3.204 0 3.584.012 4.85.07 1.366.062 2.633.332 3.608 1.308.975.975 1.245 2.242 1.308 3.608.058 1.266.07 1.646.07 4.85s-.012 3.584-.07 4.85c-.063 1.366-.333 2.633-1.308 3.608-.975.975-2.242 1.245-3.608 1.308-1.266.058-1.646.07-4.85.07s-3.584-.012-4.85-.07c-1.366-.063-2.633-.333-3.608-1.308-.975-.975-1.245-2.242-1.308-3.608-.058-1.266-.07-1.646-.07-4.85s.012-3.584.07-4.85c.063-1.366.333-2.633 1.308-3.608.975-.975 2.242-1.245 3.608-1.308 1.266-.058 1.646-.07 4.85-.07zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98 1.281.058 1.689.072 4.948.072 3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"/></svg>
                </a>
            </div>
            <p>&copy; 2026 Nutrisib - Toate drepturile rezervate.</p>
        </footer>
    </div>

    <script>
        // --- 1. VALIDARE CNP ---
        function validateCNP(cnp) {
            if (!/^[1-9]\d{12}$/.test(cnp)) return false;
            const control = [2, 7, 9, 1, 4, 6, 3, 5, 8, 2, 7, 9];
            let sum = 0;
            for (let i = 0; i < 12; i++) sum += parseInt(cnp[i]) * control[i];
            const remainder = sum % 11;
            const checkDigit = remainder === 10 ? 1 : remainder;
            return checkDigit === parseInt(cnp[12]);
        }

        // --- 2. EXTRAGERE DATĂ DIN CNP ---
        function extractDateFromCNP(cnp) {
            const s = parseInt(cnp[0]);
            const aa = cnp.substring(1, 3);
            const ll = cnp.substring(3, 5);
            const zz = cnp.substring(5, 7);
            let century = "";

            if (s === 1 || s === 2) century = "19";
            else if (s === 5 || s === 6) century = "20";
            else if (s === 3 || s === 4) century = "18";
            else return "";

            return `${century}${aa}-${ll}-${zz}`;
        }

        // --- 3. CALCUL VÂRSTĂ ---
        function calculateAge(dateString) {
            const today = new Date();
            const birthDate = new Date(dateString);
            let age = today.getFullYear() - birthDate.getFullYear();
            const m = today.getMonth() - birthDate.getMonth();
            if (m < 0 || (m === 0 && today.getDate() < birthDate.getDate())) {
                age--;
            }
            return age;
        }

        function handleCNPChange(input) {
            const cnpVal = input.value;
            const errorMsg = document.getElementById('cnpError');
            const dobInput = document.getElementById('dob');
            const guardianSection = document.getElementById('guardian-section');
            const guardianName = document.getElementById('guardian_name');
            const guardianCnp = document.getElementById('guardian_cnp');

            if (validateCNP(cnpVal)) {
                errorMsg.style.display = 'none';
                input.setCustomValidity("");
                const extractedDate = extractDateFromCNP(cnpVal);
                dobInput.value = extractedDate;

                const age = calculateAge(extractedDate);
                if (age < 18) {
                    guardianSection.style.display = 'block';
                    guardianName.setAttribute('required', 'required');
                    guardianCnp.setAttribute('required', 'required');
                } else {
                    guardianSection.style.display = 'none';
                    guardianName.removeAttribute('required');
                    guardianCnp.removeAttribute('required');
                    guardianName.value = '';
                    guardianCnp.value = '';
                }
            } else {
                if (cnpVal.length > 0) {
                    errorMsg.style.display = 'block';
                    input.setCustomValidity("CNP Invalid");
                    dobInput.value = "";
                    guardianSection.style.display = 'none';
                } else {
                    errorMsg.style.display = 'none';
                    input.setCustomValidity("");
                }
            }
        }

        function toggleSignMethod(method) {
            document.querySelectorAll('.sign-method').forEach(el => el.classList.remove('active'));
            const selected = document.getElementById('method-' + method);
            if (selected) selected.classList.add('active');
        }

        // --- Logica pentru CANVAS ---
        const canvas = document.getElementById('signatureCanvas');
        const ctx = canvas.getContext('2d');
        let isDrawing = false;
        let hasSigned = false;

        function getPos(e) {
            const rect = canvas.getBoundingClientRect();
            let clientX, clientY;
            if (e.changedTouches && e.changedTouches.length > 0) {
                clientX = e.changedTouches[0].clientX;
                clientY = e.changedTouches[0].clientY;
            } else {
                clientX = e.clientX;
                clientY = e.clientY;
            }
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            return { x: (clientX - rect.left) * scaleX, y: (clientY - rect.top) * scaleY };
        }

        function startDraw(e) {
            e.preventDefault(); 
            isDrawing = true;
            hasSigned = true;
            const pos = getPos(e);
            ctx.beginPath();
            ctx.moveTo(pos.x, pos.y);
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            const pos = getPos(e);
            ctx.lineTo(pos.x, pos.y);
            ctx.stroke();
        }

        function endDraw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            isDrawing = false;
            saveSignature();
        }

        canvas.addEventListener('mousedown', startDraw);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', endDraw);
        canvas.addEventListener('mouseout', endDraw);
        canvas.addEventListener('touchstart', startDraw, {passive: false});
        canvas.addEventListener('touchmove', draw, {passive: false});
        canvas.addEventListener('touchend', endDraw);

        ctx.lineWidth = 3;
        ctx.lineCap = 'round';
        ctx.lineJoin = 'round';
        ctx.strokeStyle = '#000';

        function clearCanvas() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            document.getElementById('signatureData').value = '';
            hasSigned = false;
        }

        function saveSignature() {
            const dataURL = canvas.toDataURL('image/png');
            document.getElementById('signatureData').value = dataURL;
        }

        // --- SUBMIT HANDLER ---
        document.getElementById('acordForm').addEventListener('submit', function(e) {
            e.preventDefault();

            const form = e.target;
            const submitBtn = document.getElementById('submitBtn');
            const formData = new FormData(form);

            // Validări suplimentare înainte de trimitere
            const method = document.querySelector('input[name="signMethod"]:checked').value;
            if (method === 'digital' && (!hasSigned)) {
                alert('Vă rugăm să semnați în caseta dedicată.');
                return;
            }

            submitBtn.innerText = "Se trimite...";
            submitBtn.disabled = true;

            fetch("/", {
                method: "POST",
                body: formData
            })
            .then(response => {
                if (response.ok) {
                    form.style.display = "none";
                    document.getElementById('success-message').style.display = "block";
                    window.scrollTo(0, 0);
                } else {
                    throw new Error('Eroare la server');
                }
            })
            .catch((error) => {
                alert("A apărut o eroare la trimitere. Vă rugăm să încercați din nou.");
                console.error(error);
                submitBtn.innerText = "Trimite Acordul Finalizat";
                submitBtn.disabled = false;
            });
        });
    </script>
</body>
</html>
